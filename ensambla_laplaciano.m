function L=ensambla_laplaciano(N)L=4*diag(ones(1, N^2));   %DiagonalL(1,2)=-1;                %Esquinas superioresL(1, N+1)=-1;L(N, N-1)=-1;L(N, 2*N)=-1;L((N-1)*N+1, (N-2)*N+1)=-1; %Esquinas inferioresL((N-1)*N+1, (N-1)*N+2)=-1;L(N^2, N^2-N)=-1;L(N^2, N^2-1)=-1;for i=2:N-1         %Banda superior   L(i, i-1)=-1;  L(i, i+1)=-1;  L(i, N+i)=-1;endforfor i=(N-1)*N+2: N^2-1 %Banda inferior  L(i, i+1)=-1;  L(i, i-1)=-1;  L(i, i-N)=-1;endforfor k=1:N-2   %Rellena fila a fila  L(k*N+1, (k-1)*N+1)=-1;    %Primero los elementos de la banda izq.  L(k*N+1, (k+1)*N+1)=-1;  L(k*N+1, k*N+2)=-1;    L((k+1)*N, (k+1)*N-1)=-1;  %luego los de la banda derecha  L((k+1)*N, k*N)=-1;  L((k+1)*N, (k+2)*N)=-1;    for j=1:N-2    L(k*N+1+j, k*N+1+j+1)=-1; %Luego el resto    L(k*N+1+j, k*N+1+j-1)=-1;    L(k*N+1+j, k*N+1+j+N)=-1;    L(k*N+1+j, k*N+1+j-N)=-1;  endfor  endfor endfunction